openapi: 3.0.3
info:
  title: API DOCUMENTATION
  version: 1.0.0
  description: Documentación de mi API con Swagger y DRF
paths:
  /api/available-methods/:
    get:
      operationId: available_methods_retrieve
      description: Lista métodos ETO disponibles
      tags:
      - available-methods
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AvailableMethodsResponse'
          description: ''
  /api/calculate-eto/:
    post:
      operationId: calculate_eto_create
      description: API endpoint para calcular ETO usando datos de NASA
      tags:
      - calculate-eto
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CalculateETORequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CalculateETORequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CalculateETORequest'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CalculateETOResponse'
          description: ''
  /api/cultivo/crops/:
    get:
      operationId: cultivo_crops_list
      tags:
      - cultivo
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Crop'
          description: ''
  /api/cultivo/crops-plant/:
    get:
      operationId: cultivo_crops_plant_list
      tags:
      - cultivo
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CropToPlant'
          description: ''
    post:
      operationId: cultivo_crops_plant_create
      tags:
      - cultivo
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CropToPlant'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CropToPlant'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CropToPlant'
        required: true
      security:
      - tokenAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CropToPlant'
          description: ''
  /api/precipitaciones/precipitations/:
    get:
      operationId: precipitaciones_precipitations_retrieve
      tags:
      - precipitaciones
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PrecipitationRecord'
          description: ''
  /api/precipitaciones/precipitations/cargar/:
    post:
      operationId: precipitaciones_precipitations_cargar_create
      tags:
      - precipitaciones
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CargarPrecipitacionInput'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CargarPrecipitacionInput'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CargarPrecipitacionInput'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CargarPrecipitacionInput'
          description: ''
  /api/precipitaciones/precipitations/diaria/rango/:
    post:
      operationId: precipitaciones_precipitations_diaria_rango_create
      tags:
      - precipitaciones
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PrecipitacionDiariaRangoInput'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PrecipitacionDiariaRangoInput'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PrecipitacionDiariaRangoInput'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PrecipitacionDiariaRangoInput'
          description: ''
  /api/precipitaciones/stations/:
    get:
      operationId: precipitaciones_stations_list
      tags:
      - precipitaciones
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Station'
          description: ''
    post:
      operationId: precipitaciones_stations_create
      tags:
      - precipitaciones
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Station'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Station'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Station'
        required: true
      security:
      - tokenAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Station'
          description: ''
  /api/precipitaciones/stations/{id}/:
    get:
      operationId: precipitaciones_stations_retrieve
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - precipitaciones
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Station'
          description: ''
    put:
      operationId: precipitaciones_stations_update
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - precipitaciones
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Station'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Station'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Station'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Station'
          description: ''
    patch:
      operationId: precipitaciones_stations_partial_update
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - precipitaciones
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedStation'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedStation'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedStation'
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Station'
          description: ''
    delete:
      operationId: precipitaciones_stations_destroy
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - precipitaciones
      security:
      - tokenAuth: []
      responses:
        '204':
          description: No response body
  /api/suelo/soils/:
    get:
      operationId: suelo_soils_list
      tags:
      - suelo
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Soil'
          description: ''
    post:
      operationId: suelo_soils_create
      tags:
      - suelo
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Soil'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Soil'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Soil'
        required: true
      security:
      - tokenAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Soil'
          description: ''
  /api/users/:
    get:
      operationId: users_list
      tags:
      - users
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CustomUser'
          description: ''
  /api/users/{id}/:
    get:
      operationId: users_retrieve
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomUser'
          description: ''
    put:
      operationId: users_update
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomUser'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CustomUser'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CustomUser'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomUser'
          description: ''
    patch:
      operationId: users_partial_update
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedCustomUser'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedCustomUser'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedCustomUser'
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomUser'
          description: ''
    delete:
      operationId: users_destroy
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      security:
      - tokenAuth: []
      responses:
        '204':
          description: No response body
  /api/users/{id}/assign-role/:
    post:
      operationId: users_assign_role_create
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignRole'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/AssignRole'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/AssignRole'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssignRoleResponse'
          description: ''
  /api/users/{id}/remove-role/:
    delete:
      operationId: users_remove_role_destroy
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - users
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RemoveRoleResponse'
          description: ''
  /api/users/change-password/:
    post:
      operationId: users_change_password_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePassword'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ChangePassword'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ChangePassword'
        required: true
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangePassword'
          description: ''
  /api/users/login/:
    post:
      operationId: users_login_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomUserLogin'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CustomUserLogin'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CustomUserLogin'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomUserLogin'
          description: ''
  /api/users/register/:
    post:
      operationId: users_register_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomUser'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CustomUser'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CustomUser'
        required: true
      security:
      - tokenAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomUser'
          description: ''
components:
  schemas:
    AssignRole:
      type: object
      properties:
        role:
          type: string
          writeOnly: true
      required:
      - role
    AssignRoleResponse:
      type: object
      properties:
        message:
          type: string
        role:
          type: string
      required:
      - message
      - role
    AvailableMethodsResponse:
      type: object
      properties:
        methods:
          type: array
          items:
            type: string
      required:
      - methods
    CalculateETORequest:
      type: object
      properties:
        latitude:
          type: number
          format: double
        longitude:
          type: number
          format: double
        start_date:
          type: string
          format: date
        end_date:
          type: string
          format: date
        method:
          allOf:
          - $ref: '#/components/schemas/MethodEnum'
          default: penman-monteith
        altitude:
          type: number
          format: double
          default: 0.0
      required:
      - end_date
      - latitude
      - longitude
      - start_date
    CalculateETOResponse:
      type: object
      properties:
        success:
          type: boolean
        eto:
          type: number
          format: double
        method:
          type: string
        period:
          type: string
        coordinates:
          type: string
        observations:
          type: string
      required:
      - coordinates
      - eto
      - method
      - observations
      - period
      - success
    CargarPrecipitacionInput:
      type: object
      properties:
        station_id:
          type: integer
        year:
          type: integer
          minimum: 1981
      required:
      - station_id
      - year
    ChangePassword:
      type: object
      properties:
        old_password:
          type: string
        new_password:
          type: string
      required:
      - new_password
      - old_password
    Crop:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        nombre:
          type: string
          maxLength: 100
        kc_inicial:
          type: number
          format: double
        kc_desarrollo:
          type: number
          format: double
        kc_medio:
          type: number
          format: double
        kc_fin:
          type: number
          format: double
        etapa_inicial:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Duración etapa inicial (días)
        etapa_desarrollo:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Duración etapa desarrollo (días)
        etapa_medio:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Duración etapa media (días)
        etapa_final:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: Duración etapa final (días)
        prof_radicular_ini:
          type: number
          format: double
          description: Profundidad radicular inicial (m)
        prof_radicular_desarrollo:
          type: number
          format: double
          description: Profundidad radicular desarrollo (m)
        prof_radicular_medio:
          type: number
          format: double
          description: Profundidad radicular media (m)
        prof_radicular_final:
          type: number
          format: double
          description: Profundidad radicular final (m)
        agotam_critico:
          type: number
          format: double
          description: Agotamiento crítico (fracción)
        factor_respuesta_rend:
          type: number
          format: double
          description: Factor de respuesta a rendimiento
        altura_min:
          type: number
          format: double
          description: Altura mínima del cultivo (m)
        altura_max:
          type: number
          format: double
          description: Altura máxima del cultivo (m)
      required:
      - agotam_critico
      - altura_max
      - altura_min
      - etapa_desarrollo
      - etapa_final
      - etapa_inicial
      - etapa_medio
      - factor_respuesta_rend
      - id
      - kc_desarrollo
      - kc_fin
      - kc_inicial
      - kc_medio
      - nombre
      - prof_radicular_desarrollo
      - prof_radicular_final
      - prof_radicular_ini
      - prof_radicular_medio
    CropToPlant:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        crear_nuevo_cultivo:
          type: boolean
          writeOnly: true
        crop:
          type: integer
        crop_data:
          allOf:
          - $ref: '#/components/schemas/Crop'
          writeOnly: true
        fecha_siembra:
          type: string
          format: date
        fecha_cosecha:
          type: string
          format: date
        altura:
          type: number
          format: double
      required:
      - altura
      - crear_nuevo_cultivo
      - fecha_cosecha
      - fecha_siembra
      - id
    CustomUser:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          nullable: true
        email:
          type: string
          format: email
          maxLength: 254
        password:
          type: string
          writeOnly: true
        role:
          type: array
          items:
            type: string
          readOnly: true
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
      required:
      - email
      - id
      - password
      - role
      - username
    CustomUserLogin:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
      required:
      - email
      - password
    MethodEnum:
      enum:
      - penman-monteith
      - hargreaves
      - turc
      - makkink
      - makkink-abstew
      - simple-abstew
      - priestley-taylor
      - ivanon
      - christiansen
      type: string
      description: |-
        * `penman-monteith` - penman-monteith
        * `hargreaves` - hargreaves
        * `turc` - turc
        * `makkink` - makkink
        * `makkink-abstew` - makkink-abstew
        * `simple-abstew` - simple-abstew
        * `priestley-taylor` - priestley-taylor
        * `ivanon` - ivanon
        * `christiansen` - christiansen
    PatchedCustomUser:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          nullable: true
        email:
          type: string
          format: email
          maxLength: 254
        password:
          type: string
          writeOnly: true
        role:
          type: array
          items:
            type: string
          readOnly: true
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
    PatchedStation:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        user:
          type: integer
          readOnly: true
        name:
          type: string
          maxLength: 100
        latitude:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,5})?$
          nullable: true
        longitude:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,5})?$
          nullable: true
    PrecipitacionDiariaRangoInput:
      type: object
      properties:
        station_id:
          type: integer
        start_date:
          type: string
          format: date
        end_date:
          type: string
          format: date
      required:
      - end_date
      - start_date
      - station_id
    PrecipitationRecord:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        station:
          type: integer
        year:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        month:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        precipitation:
          type: number
          format: double
        effective_precipitation:
          type: number
          format: double
          nullable: true
      required:
      - id
      - month
      - precipitation
      - station
      - year
    RemoveRoleResponse:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    Soil:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        nombre:
          type: string
          maxLength: 100
        humedad_disponible:
          type: number
          format: double
          description: Humedad de suelo disponible total (CC-PMP) en mm/metro
        tasa_max_infiltracion:
          type: number
          format: double
          description: Tasa máxima de infiltración de la precipitación en mm/día
        profundidad_radicular_max:
          type: number
          format: double
          description: Profundidad radicular máxima en cm
        agotamiento_inicial:
          type: number
          format: double
          description: Agotamiento inicial de humedad de suelo (% de ADT)
        humedad_inicial:
          type: number
          format: double
          description: Humedad de suelo inicialmente disponible en mm/metro
        user:
          type: integer
          readOnly: true
          nullable: true
      required:
      - agotamiento_inicial
      - humedad_disponible
      - humedad_inicial
      - id
      - nombre
      - profundidad_radicular_max
      - tasa_max_infiltracion
      - user
    Station:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        user:
          type: integer
          readOnly: true
        name:
          type: string
          maxLength: 100
        latitude:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,5})?$
          nullable: true
        longitude:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,5})?$
          nullable: true
      required:
      - id
      - name
      - user
  securitySchemes:
    tokenAuth:
      type: apiKey
      in: header
      name: Authorization
      description: Token-based authentication with required prefix "Token"
